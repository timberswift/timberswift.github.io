<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>UWP学习(三)--My Naïve Mondrian Player | 你好</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="你好" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/archives" class="header__link">Archive</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="../../../../index.html">你好</a></h1>
		<h2 class="header__subtitle"></h2>
	</header>

	<main>
		<article>
	
		<h1>UWP学习(三)--My Naïve Mondrian Player</h1>
	
	<div class="article__infos">
		<span class="article__date">2018-04-01</span><br />
		
		
	</div>

	


	
		<h3 id="GitHub项目链接"><a href="#GitHub项目链接" class="headerlink" title="GitHub项目链接"></a><a href="https://github.com/timberswift/NaiveMondrianPlayer" target="_blank" rel="noopener">GitHub项目链接</a></h3><h2 id="项目成果"><a href="#项目成果" class="headerlink" title="项目成果"></a>项目成果</h2><ul>
<li><p>播放器主界面</p>
<p><figure class="figure"><img src="/2018/04/01/uwp3-1/main.png" alt=""></figure></p>
</li>
<li><p>选择音频文件并播放</p>
<p><figure class="figure"><img src="/2018/04/01/uwp3-1/mp3c.png" alt=""></figure></p>
<p><figure class="figure"><img src="/2018/04/01/uwp3-1/mp3.png" alt=""></figure></p>
<p>​</p>
</li>
<li><p>选择视频文件并播放</p>
<p><figure class="figure"><img src="/2018/04/01/uwp3-1/mp4c.png" alt=""></figure></p>
<p><figure class="figure"><img src="/2018/04/01/uwp3-1/mp42.png" alt=""></figure></p>
</li>
</ul>
<h2 id="技术问题"><a href="#技术问题" class="headerlink" title="技术问题"></a>技术问题</h2><h3 id="1-界面设计"><a href="#1-界面设计" class="headerlink" title="1.界面设计"></a>1.界面设计</h3><p>​    可视化程序设计，重点还是在可视化上~ 即使是这样一个简单的程序，它也应该拥有开发者对其界面设计的一个端正态度的权利。因此我遇到的第一个问题就是，界面设计。<br>    界面设计是建立在掌握了软件功能的前提之上。因为只有清楚了软件功能需求，才会知道界面的模块格局与主体控件。根据软件需求，主体控件自然是MediaPlayerElement。然后还需要有文件选择入口。我选择了使用最简单的Button实现。另外，我觉得还需要有显示文件名的一栏。在掌握着功能需要后，开始构思界面排版与风格。了解到几个模块特性，我想到的总体风格，没错，就是老师之前讲到过的蒙德里安经典风格的格子画。</p>
<ul>
<li>先说效果问题：要想掌握蒙德里安的精髓可是相当难啊~你得考虑线条的粗细、格子的交错和大小、格子的颜色搭配填充和颜色饱和度选取以使得界面协调等很多因素。</li>
<li>再说技术问题: 实现格子风格设计的xaml技术不算复杂。主体控件是Grid，实现线条其实有两个思路。一是在每个网格里填充满线条的颜色，然后填进去的色块只需要Margin线条宽度值就好(其实这个思路是我实现了第二种思路后才想到的–)。二是直接做线条宽度的格子，在里面填充黑色背景。然后色块的交错排版选择StackPanel是很好的选择。另外，我还使用了相当部分的border控件，直接填充颜色，形成蒙德里安风格色块。就这样简单~</li>
</ul>
<p>但是在效果和技术完美结合上，耗费了我大部分时间。。整个过程是没有参考文档的，如果<a href="https://www.zhihu.com/question/24127981" target="_blank" rel="noopener">如何理解蒙德里安格子画精髓</a>也算?</p>
<p>我的xaml代码:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Page</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Class</span>=<span class="string">"MediaPlayer.MainPage"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:x</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:local</span>=<span class="string">"using:MediaPlayer"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:d</span>=<span class="string">"http://schemas.microsoft.com/expression/blend/2008"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mc</span>=<span class="string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">mc:Ignorable</span>=<span class="string">"d"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">".1*"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"auto"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"auto"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">".13*"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">"auto"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">".9*"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span> <span class="attr">Grid.Row</span>=<span class="string">"0"</span>  <span class="attr">Width</span>=<span class="string">"auto"</span> <span class="attr">Height</span>=<span class="string">"auto"</span> <span class="attr">Background</span>=<span class="string">"Red"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"1"</span> <span class="attr">Grid.Row</span>=<span class="string">"0"</span> <span class="attr">Width</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"1"</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Width</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"1"</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span> <span class="attr">Height</span>=<span class="string">"5"</span> <span class="attr">Width</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span> <span class="attr">Height</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"2"</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span> <span class="attr">Height</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Height</span>=<span class="string">"auto"</span> <span class="attr">Orientation</span>=<span class="string">"Vertical"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Background</span>=<span class="string">"#2586BB"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Name</span>=<span class="string">"chose"</span> <span class="attr">HorizontalAlignment</span>=<span class="string">"Center"</span>   <span class="attr">Foreground</span>=<span class="string">"White"</span> <span class="attr">FontSize</span>=<span class="string">"14px"</span> <span class="attr">Margin</span>=<span class="string">"2,10,2,10"</span> <span class="attr">Padding</span>=<span class="string">"2,0,2,0"</span> <span class="attr">FontFamily</span>=<span class="string">"Microsoft YaHei"</span> <span class="attr">FontWeight</span>=<span class="string">"Normal"</span>&gt;</span>选择文件类型<span class="tag">&lt;/<span class="name">TextBlock</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"3"</span>  <span class="attr">Background</span>=<span class="string">"#2586BB"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Background</span>=<span class="string">"White"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Name</span>=<span class="string">"choose_mp3"</span>  <span class="attr">HorizontalAlignment</span>=<span class="string">"Center"</span> <span class="attr">Content</span>=<span class="string">"MP3"</span>  <span class="attr">Width</span>=<span class="string">"150"</span> <span class="attr">Height</span>=<span class="string">"40"</span> <span class="attr">Background</span>=<span class="string">"White"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">Click</span>=<span class="string">"choose_mp3_Click"</span> <span class="attr">FontFamily</span>=<span class="string">"Adobe Gothic Std B"</span> <span class="attr">FontWeight</span>=<span class="string">"Bold"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"3"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Background</span>=<span class="string">"White"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Name</span>=<span class="string">"choose_mp4"</span>  <span class="attr">HorizontalAlignment</span>=<span class="string">"Center"</span> <span class="attr">Content</span>=<span class="string">"MP4"</span>  <span class="attr">Width</span>=<span class="string">"150"</span> <span class="attr">Height</span>=<span class="string">"40"</span> <span class="attr">Background</span>=<span class="string">"White"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">Click</span>=<span class="string">"choose_mp4_Click"</span> <span class="attr">FontFamily</span>=<span class="string">"Adobe Gothic Std B"</span> <span class="attr">FontWeight</span>=<span class="string">"Bold"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"100"</span>  <span class="attr">Background</span>=<span class="string">"#2586BB"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Width</span>=<span class="string">"auto"</span> <span class="attr">Height</span>=<span class="string">"200"</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Orientation</span>=<span class="string">"Vertical"</span> <span class="attr">Height</span>=<span class="string">"200"</span> <span class="attr">Width</span>=<span class="string">"73"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"120"</span>  <span class="attr">Background</span>=<span class="string">"Yellow"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"35"</span>  <span class="attr">Background</span>=<span class="string">"White"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"5"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"35"</span>  <span class="attr">Background</span>=<span class="string">"White"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Width</span>=<span class="string">"4"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Width</span>=<span class="string">"500"</span>  <span class="attr">Background</span>=<span class="string">"Black"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span>  <span class="attr">Height</span>=<span class="string">"4"</span>  <span class="attr">Background</span>=<span class="string">"#353535"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Height</span>=<span class="string">"500"</span> <span class="attr">Background</span>=<span class="string">"Red"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Column</span>=<span class="string">"2"</span> <span class="attr">Grid.Row</span>=<span class="string">"0"</span>  <span class="attr">Background</span>=<span class="string">"Yellow"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Name</span>=<span class="string">"media_title"</span>   <span class="attr">HorizontalAlignment</span>=<span class="string">"Center"</span>  <span class="attr">VerticalAlignment</span>=<span class="string">"Center"</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">Text</span>=<span class="string">"Welcome"</span> <span class="attr">FontSize</span>=<span class="string">"20px"</span> <span class="attr">FontFamily</span>=<span class="string">"Arial Black"</span> <span class="attr">FontWeight</span>=<span class="string">"Bold"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Border</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Grid.Column</span>=<span class="string">"2"</span> <span class="attr">Background</span>=<span class="string">"#FFF8FF"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MediaPlayerElement</span> <span class="attr">Name</span>=<span class="string">"my_player"</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">AreTransportControlsEnabled</span>=<span class="string">"True"</span> <span class="attr">FontFamily</span>=<span class="string">"Adobe Arabic"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">MediaPlayerElement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Grid.Column</span>=<span class="string">"2"</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Image</span> <span class="attr">Name</span>=<span class="string">"mp3_logo"</span> <span class="attr">Width</span>=<span class="string">"300"</span> <span class="attr">Height</span>=<span class="string">"300"</span> <span class="attr">Source</span>=<span class="string">"Assets/mp32.jpg"</span> <span class="attr">Margin</span>=<span class="string">"0,0,0,100"</span> <span class="attr">Opacity</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Image</span> <span class="attr">Name</span>=<span class="string">"welcome"</span> <span class="attr">Width</span>=<span class="string">"300"</span> <span class="attr">Height</span>=<span class="string">"50"</span> <span class="attr">Source</span>=<span class="string">"Assets/logo2.png"</span> <span class="attr">Margin</span>=<span class="string">"0,40,0,0"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Image</span> <span class="attr">Name</span>=<span class="string">"logo"</span> <span class="attr">Width</span>=<span class="string">"200"</span> <span class="attr">Height</span>=<span class="string">"150"</span> <span class="attr">Source</span>=<span class="string">"Assets/grid.jpg"</span> <span class="attr">Margin</span>=<span class="string">"0,0,0,200"</span> <span class="attr">Opacity</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Page</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-文件选择"><a href="#2-文件选择" class="headerlink" title="2.文件选择"></a>2.文件选择</h3><p>文件选择这块是这个软件的核心板块。在实现播放器之前，我想先尝试着推测梳理一下整个软件实现的思路流程。</p>
<ul>
<li>首先要有一个文件选择器。用户可以根据系统自带的文件选取可视化界面选取相应文件。</li>
<li>然后要对文件选取的格式进行约束。在此软件中就是音频和视频文件。选择成功后，文件选择器要返回一个文件对象或者文件路径。</li>
<li>播放器相关接口接收到这个文件对象或者文件路径后，实现播放的功能。</li>
</ul>
<p>应着自己初步的思路，我先查找了C#实现文件选择器的相关文档。<br><a href="https://blog.csdn.net/u011033906/article/details/65448394" target="_blank" rel="noopener">参考文档链接</a><br>文档的参考代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//1.创建和自定义 FileOpenPicker</span><br><span class="line">var picker = new Pickers.FileOpenPicker();</span><br><span class="line">picker.ViewMode = Pickers.PickerViewMode.Thumbnail;</span><br><span class="line">picker.SuggestedStartLocation = Pickers.PickerLocationId.PicturesLibrary;</span><br><span class="line"></span><br><span class="line">picker.FileTypeFilter.Add(&quot;.jpg&quot;);</span><br><span class="line">picker.FileTypeFilter.Add(&quot;.jpeg&quot;);</span><br><span class="line">picker.FileTypeFilter.Add(&quot;.png&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Windows.Storage.StorageFile file = await picker.PickSingleFileAsync();</span><br><span class="line">if (file != null)</span><br><span class="line">&#123;</span><br><span class="line">    // Application now has read/write access to the picked file</span><br><span class="line">    this.textBlock.Text = &quot;Picked photo: &quot; + file.Name;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    this.textBlock.Text = &quot;Operation cancelled.&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>根据参考代码，看来跟自己之前的思路基本吻合。首先是通过FileOpenPicker声明一个对象，这个对象通过对文件格式的筛选，在用户选择完成后，生成某个类型(C#的var特性也是超级好用~)的file对象。我想有了这个file，只需要修改if(file != null){}内的内容，接下来交给mediaplayer处理，应该就实现了。<br>接下来，解决mediaplayerelement实现播放的问题。<br>首先参考的是xaml controls gallery。里面对控件的前端实现很简单，要实现后端媒体播放功能，还得查询<a href="https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.mediaelement" target="_blank" rel="noopener">微软官方文档</a>。<br>参考代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private async void Button_Click(object sender, RoutedEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    await SetLocalMedia();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async private System.Threading.Tasks.Task SetLocalMedia()</span><br><span class="line">&#123;</span><br><span class="line">    var openPicker = new Windows.Storage.Pickers.FileOpenPicker();</span><br><span class="line"></span><br><span class="line">    openPicker.FileTypeFilter.Add(&quot;.wmv&quot;);</span><br><span class="line">    openPicker.FileTypeFilter.Add(&quot;.mp4&quot;);</span><br><span class="line">    openPicker.FileTypeFilter.Add(&quot;.wma&quot;);</span><br><span class="line">    openPicker.FileTypeFilter.Add(&quot;.mp3&quot;);</span><br><span class="line"></span><br><span class="line">    var file = await openPicker.PickSingleFileAsync();</span><br><span class="line"></span><br><span class="line">    // mediaPlayer is a MediaElement defined in XAML</span><br><span class="line">    if (file != null)</span><br><span class="line">    &#123;</span><br><span class="line">        var stream = await file.OpenAsync(Windows.Storage.FileAccessMode.Read);</span><br><span class="line">        mediaPlayer.SetSource(stream, file.ContentType);</span><br><span class="line"></span><br><span class="line">        mediaPlayer.Play();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>​    这份参考代码与之前的参考代码惊人的相似。我便知道我离成功仅半步之遥了。不过微软这段官方的参考代码却有很多值得学习的地方，这个async await异步线程特性的使用。在UI线程里不处理复杂任务，async await特性完美解决了不需要new thread()便实现了这个任务。<br>    根据两个参考代码，我的代码自然也就水到渠成了，只需要对自己的特性进行微小的调整。在map3选择button和mp4选择button下均处理异步线程的文件选取事件。但是为了区分格式，我设置了标志变量flag，在MP3按钮下设置为0，MP4按钮下设置为1，再当成形参传入异步线程任务里让其区分。另外，加入了界面切换模块。</p>
<p>我的代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">public MainPage()</span><br><span class="line">       &#123;</span><br><span class="line">           this.InitializeComponent();</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">       int flag = -1;  // to mark the mp3 or mp4 button choose</span><br><span class="line">	//音频文件选择处理事件</span><br><span class="line">       private async void choose_mp3_Click(object sender, RoutedEventArgs e)</span><br><span class="line">       &#123;</span><br><span class="line">           //若点击MP3文件选择按钮，flag标志设为0</span><br><span class="line">           flag = 0;     </span><br><span class="line">           await SetLocalMedia(flag);</span><br><span class="line">           //切换界面</span><br><span class="line">           mp3_logo.Opacity = 1;</span><br><span class="line">           logo.Opacity = 0;</span><br><span class="line">           welcome.Opacity = 0;</span><br><span class="line">       &#125;</span><br><span class="line">	//视频文件选择处理事件</span><br><span class="line">       private async void choose_mp4_Click(object sender, RoutedEventArgs e)</span><br><span class="line">       &#123;</span><br><span class="line">           //若点击MP4文件选择按钮，flag标志设为1</span><br><span class="line">           flag = 1;</span><br><span class="line">           await SetLocalMedia(flag);</span><br><span class="line">           //切换界面</span><br><span class="line">           logo.Opacity = 0;</span><br><span class="line">           welcome.Opacity = 0;</span><br><span class="line">           mp3_logo.Opacity = 0;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       async private System.Threading.Tasks.Task SetLocalMedia(int flag)</span><br><span class="line">       &#123;</span><br><span class="line">           FileOpenPicker openPicker = new FileOpenPicker();</span><br><span class="line">           if(flag == 0)</span><br><span class="line">           &#123;</span><br><span class="line">               openPicker.FileTypeFilter.Add(&quot;.mp3&quot;);</span><br><span class="line">               openPicker.FileTypeFilter.Add(&quot;.wma&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">           else if(flag == 1)</span><br><span class="line">           &#123;   </span><br><span class="line">               openPicker.FileTypeFilter.Add(&quot;.mp4&quot;);</span><br><span class="line">               openPicker.FileTypeFilter.Add(&quot;.wmv&quot;);</span><br><span class="line">           &#125;  </span><br><span class="line"></span><br><span class="line">           var file = await openPicker.PickSingleFileAsync();</span><br><span class="line"></span><br><span class="line">           if (file != null)</span><br><span class="line">           &#123;</span><br><span class="line">               //播放器标题栏设为文件名，文件名可通过file的属性值直接获取</span><br><span class="line">               media_title.Text = file.Name;        </span><br><span class="line">               my_player.Source = MediaSource.CreateFromStorageFile(file);</span><br><span class="line">               my_player.MediaPlayer.Play();</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-界面切换和媒体名显示"><a href="#3-界面切换和媒体名显示" class="headerlink" title="3.界面切换和媒体名显示"></a>3.界面切换和媒体名显示</h3><p>​    在播放器基本功能实现完成之后，还有一点小问题需要解决。就是播放音频文件时的标识。我想到了用一个Image控件显示音频图标，以明显展示正在播放的文件类型。但是在用户没有选择文件播放之前这个标示图是不能显示在主界面了，这涉及到对控件的隐藏。于是我查询了有关<a href="https://blog.csdn.net/nomasp/article/details/50263383" target="_blank" rel="noopener">隐藏控件相关的文档</a>。可惜的是C#关于visible和opacity的对比相关资料很少，css倒是一大把。我猜他们大概的区别都差不多吧。查阅文档后知道了visible与opacity(透明度)都能实现对控件的隐藏。区别是visible为false后相关的点击事件也取消了，而opacity调为0后虽然控件不可见但是你还是可以点击它触发事件。我采用的opacity实现。</p>
<p>代码就是修改控件的opacity而已：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    mp3_logo.Opacity = 1; 	//切换到MP3文件，MP3 logo显示</span><br><span class="line">	logo.Opacity = 0;		//播放器logo隐藏</span><br><span class="line">	welcome.Opacity = 0;	//欢迎页隐藏</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>媒体名的显示也很简单。还记得刚才file对象，它里面应该有自己的name属性。直接调用显示在textblock就行了。代码很简单：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">media_title.Text = file.Name;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>​    整个流程实现下来其实还是挺顺畅的(别做梦了，只是你实现的功能too young too naive而已..),我觉得一个好的界面是一个应用有趣的灵魂之一，所以我觉得花一定精力去设计你的软件界面是很有必要的一件事。在初步实现了我的界面<br>还有，在实现一些功能之前，自己不妨可以先推测并梳理一下究竟大概是以怎样的步骤去实现，必要条件是哪些(即使你暂时不知道具体的代码实现)、模块的结合是怎样的。然后在自己的问题中分条查询文档，当发现这些参考文档的异同中，你也许就有了自己的思路和解决方案。具体干货：善用var、善用async await、善用搜索引擎。</p>

	

	
		<span class="different-posts"><a href="" onclick="window.history.go(-1); return false;">⬅️ Go back </a></span>

	





	<!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="MTAyMC8zNDk1Ni8xMTQ5Mw==">
	<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
<noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 -->
</article>

	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>Hi there, <br />welcome to my Blog glad you found it. Have a look around, will you?</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2018 timberswift | Powered by <a href="https://hexo.io/">Hexo</a> | Theme <a href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
